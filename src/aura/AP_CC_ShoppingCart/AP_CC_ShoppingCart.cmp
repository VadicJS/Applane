<aura:component description="AP_CC_ShoppingCart" controller="AP_CC_AirplaneAppointmentController" extends="forceCommunity:navigationMenuBase" implements="forceCommunity:availableForAllPageTypes">
    <aura:attribute name="appointments" type="Object[]"/>
    <aura:attribute name="events" type="Object[]"/>
    <aura:attribute name="showSpinner" type="Boolean"/>
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:handler event="c:AP_CC_AppointmentAdded" action="{!c.doInit}"/>
    <aura:handler name="AP_CC_EventRemoved" event="c:AP_CC_EventRemoved" action="{!c.removeTile}"/>
    <br/>
    <div style="display: flex; justify-content : flex-end;">
        <lightning:button label="{!$Label.c.AP_Meetings}" class="slds-m-top--medium btn" variant="brand" onclick="{!c.openModal}"/>
    </div>
    <c:AP_Spinner show="{!v.showSpinner}"/>
    <div class="demo-only" style="height: 640px; display:none;" id="modal">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
            <div class="slds-modal__container">
                <aura:if isTrue="{!v.appointments.length > 0}">
                    <header class="slds-modal__header">
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Please confirm these meetings</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium row" id="modal-content-id-1" style="font-size: 1.1em;">
                        <aura:iteration items="{!v.appointments}" var="app" indexVar="idx">
                            <c:AP_CC_AppointmentItem appointment="{!app}" index="{!idx}"/>
                        </aura:iteration>
                    </div>
                </aura:if>
                <aura:if isTrue="{!v.events.length > 0}">
                    <header class="slds-modal__header">
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Upcoming meetings</h2>
                    </header>
                    <div style="max-height: 200px; overflow: auto;">
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                            <thead>
                            <tr class="slds-text-title_caps">
                                <th scope="col">
                                    <div class="slds-truncate" title="{!$Label.c.AP_Description}">{!$Label.c.AP_Description}</div>
                                </th>
                                <th scope="col">
                                    <div class="slds-truncate" title="{!$Label.c.AP_Duration}">{!$Label.c.AP_Duration}</div>
                                </th>
                                <th scope="col">
                                    <div class="slds-truncate" title="{!$Label.c.AP_Location}">{!$Label.c.AP_Location}</div>
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            <aura:iteration items="{!v.events}" var="evt">
                                <tr>
                                    <td>
                                            {!evt.Description}
                                    </td>
                                    <td>
                                        <lightning:formattedDateTime value="{!evt.StartDateTime}" year="numeric" month="numeric" day="numeric" hour="2-digit"
                                                                     minute="2-digit" timeZone="UTC" timeZoneName="short" hour12="false"/>
                                        -
                                        <lightning:formattedDateTime value="{!evt.EndDateTime}" year="numeric" month="numeric" day="numeric" hour="2-digit"
                                                                     minute="2-digit" timeZone="UTC" timeZoneName="short" hour12="false"/>
                                    </td>
                                    <td>
                                            {!evt.Location}
                                    </td>
                                </tr>
                            </aura:iteration>
                            </tbody>
                        </table>
                    </div>
                </aura:if>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick="{!c.closeModal}">{!$Label.c.AP_Close}</button>
                    <button class="slds-button slds-button_brand" onclick="{!c.insertEvents}" disabled="{!v.appointments.length == 0 ? 'disabled' : false }">{!$Label.c.Confirm}</button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
</aura:component>
